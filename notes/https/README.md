# 关于 HTTPS 的一些基本概念

## 基本概念

*   公钥基础设施(Public Key Infrastructure, PKI)

    PKI是一种遵循标准的利用公钥加密技术为电子商务的开展提供一套安全基础平台的技术和规范。

    支持公开密钥管理并能支持认证、加密、完整性和可追究性服务的基础设施。

    PKI 主要包括四个部分：X.509 格式的证书（X.509 V3）和证书废止列表CRL（X.509 V2）；CA 操作协议；CA 管理协议；CA 政策制定。

*   X.509

    X.509是被广泛使用的数字证书标准，是由国际电联电信委员会（ITU-T）为单点登录（SSO-Single Sign-on）和
    授权管理基础设施（PMI-Privilege Management Infrastructure）制定的PKI标准。

*   数字证书认证中心(Certificate Authority, CA)

    CA是PKI系统中通信双方都信任的实体，被称为可信第三方（Trusted Third Party，简称TTP）

    发放、管理、废除数字证书的机构。CA的作用是检查证书持有者身份的合法性，并签发证书（在证书上签字），
    以防证书被伪造或篡改，以及对证书和密钥进行管理。

    CA提供的服务：颁发证书、废除证书、更新证书、验证证书、管理密钥。

*   注册中心(RA)

    RA是CA功能的一部分，可以由CA机构以外的其他机构来完成。

    具有下列一项或多项功能的实体：标识和鉴别证书申请者，同意或拒绝证书申请，在某些环境下主动吊销或挂起证书，
    处理订户吊销或挂起其证书的请求，同意或拒绝订户更新其证书或密钥的请求。

    但是，RA并不签发证书（即RA代表CA承担某些任务）。
    总的来说，认证中心是面向各注册中心的，而注册中心是面向最终用户的，注册中心是用户与认证中心的中间渠道。

*   证书撤销列表(Certificate Revocation List, CRL)

    用于列出客户机或服务器用户不应再信任的所有证书和密钥。CRL 由 CA 生成并定期更新。

*   数字证书(Certificate)

    数字证书实际上是存于计算机上的一个记录，是由CA签发的一个声明，证明证书主体与证书中所包含的公钥的惟一对应关系。

    证书包括证书申请者的名称及相关信息、申请者的公钥、签发证书的CA的数字签名及证书的有效期等内容。

    数字证书的作用是使网上交易的双方互相验证身份，保证电子商务的安全进行。

*   证书签署请求(Certificate Signing Request, CSR)

    证书申请者在申请数字证书时由CSP(加密服务提供者)在生成私钥的同时也生成CSR文件，
    证书申请者只要把CSR文件提交给证书颁发机构后，证书颁发机构使用其根证书私钥签名就生成了证书公钥文件，也就是颁发给用户的证书。

## 证书流程

*   客户端

    客户端浏览器会预置根证书，里面包含CA公钥

*   服务器端

    生成证书签署请求，通过可靠方式发送给CA服务器

*   CA

    CA 用自己的签名签署服务器发来的证书签署请求，然后将证书下发给服务器

## 完整实例

*   [用Node.js创建自签名的HTTPS服务器](https://cnodejs.org/topic/54745ac22804a0997d38b32d)

## 参考资料

*   [加密解密技术介绍和OpenSSL介绍](http://flyalways.blog.51cto.com/7680670/1733393/)
*   [openssl的man中文文档](http://www.chinaunix.net/old_jh/13/478901.html)
*   [HTTPS 客户端验证 服务端证书流程](http://www.jianshu.com/p/0d59d2216c64)
*   [建立你自己的 CA 服务：OpenSSL 命令行 CA 操作快速指南](https://linux.cn/article-5443-weibo.html)

